# ----------------------------------------------------------------------------------------------
# FOS - Fools Of Security
# 
# Rule Written to patch the  security  issue  on Comodo Rules Set to block the payload mentioned on README.md 
# If any error or  false positive detection because of our rules, please create a issue on our repostories and we
# will fix the issue and update it with new rules.
#
# Tested on Apache/2.4.25 (Debian)
# ---------------------------------------------------------------------------------
# This is a FILE CONTAINING CHANGED or MODIFIED RULES FROM THE:
# OWASP ModSecurity Core Rule Set (CRS) & Comodo Rules Set
# ----------------------------------------------------------------------------------

SecRule REQUEST_URI "@contains /wp-login.php?action=lostpassword" \
	"id:333334,chain,msg:'FOS WAF: Unauthorized Password Reset in WordPress 4.7.x to 4.7.4 (CVE-2017-8295)',phase:2,deny,status:403,log,t:none,rev:2,severity:2,tag:'FOS WAF',tag:'WordPress'"

#change the 127.0.0.1 to your host name i.e example.com
SecRule REQUEST_HEADERS:Host "!@streq 127.0.0.1"  "t:none"
